<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.TaskMapper">
	<!-- 회원가입 기능 -->
	<insert id="doJoin" parameterType="com.example.demo.dto.TaskDto">
		insert into "USER_INFO" values(#{id}, #{pw}, #{name}, #{phone}, #{email}, #{addr})
	</insert>
	
	<!-- 아이디 존재여부 count로 확인 -->
	<select id="checkId" resultType="int">
		select count(*) from "USER_INFO" where id=#{id}
	</select>
	
	<!-- 로그인 -->
	<select id="doLogin" resultType="com.example.demo.dto.TaskDto">
		select * from "USER_INFO" where id=#{id} and pw=#{pw}
	</select>
	
	<!-- 자동 로그인 -->
	<update id="autoLogin">
		update "USER_INFO" set sessionkey = #{sessionId}, sessionlimit = #{sessionlimit} where id=#{id}
	</update>
	
	<!-- 쿠키 시간 유지 동안 사용자 정보 가져오기 -->
	<select id="checkTime" resultType="com.example.demo.dto.TaskDto">
		select * from "USER_INFO" where sessionkey=#{sessionId } and sessionlimit>now()
	</select>
</mapper>